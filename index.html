<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veridian Forge | The Architect's Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/localforage/1.10.0/localforage.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Fauna+One&family=Fira+Code:wght@300;400&display=swap" rel="stylesheet">
    <style>
        :root { 
            --onyx: #080808; 
            --charcoal: #121212;
            --gold: #D4AF37; 
            --platinum: #E0E0E0;
            --glass: rgba(30, 30, 30, 0.4);
        }

        body { 
            font-family: 'Fauna One', serif; 
            background-color: var(--onyx); 
            color: var(--gold); 
            margin: 0; 
            overflow: hidden; 
        }

        /* --- THE LUXURY THEME --- */
        .forge-theme { 
            background: radial-gradient(circle at 50% -20%, #1a1a1a 0%, #000000 80%);
            min-height: 100vh;
            position: relative;
        }
        
        /* Subtle Noise Texture for "Paper" feel */
        .forge-theme::before {
            content: ""; position: absolute; inset: 0;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.03'/%3E%3C/svg%3E");
            pointer-events: none;
        }

        /* --- TYPOGRAPHY --- */
        .lux-serif { font-family: 'Cinzel', serif; letter-spacing: 0.1em; }
        .tech-mono { font-family: 'Fira Code', monospace; }

        /* The Stacked Header */
        .header-stack {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            margin-bottom: 20px;
        }
        .title-veridian {
            font-size: 2.2rem; color: var(--platinum); letter-spacing: 0.4em;
            text-shadow: 0 0 20px rgba(255,255,255,0.1);
        }
        .title-hub {
            font-size: 1.2rem; color: var(--gold); letter-spacing: 0.6em;
            font-weight: 700; opacity: 0.9; margin-top: -5px;
        }

        /* --- THE GLASS SHELF --- */
        .shelf-container {
            display: flex; gap: 30px; 
            overflow-x: auto; padding: 20px 8vw 120px 8vw;
            scroll-snap-type: x mandatory; scrollbar-width: none;
            align-items: center; height: 55vh;
            mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);
        }
        .shelf-container::-webkit-scrollbar { display: none; }

        /* The Obsidian Data Slate */
        .data-slate {
            scroll-snap-align: center;
            min-width: 240px; height: 320px;
            background: linear-gradient(145deg, #161616, #0d0d0d);
            border: 1px solid #333;
            border-radius: 4px;
            display: flex; flex-direction: column; justify-content: space-between;
            padding: 25px;
            position: relative;
            cursor: pointer;
            transition: 0.5s cubic-bezier(0.2, 0.8, 0.2, 1);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .data-slate:hover {
            transform: translateY(-10px);
            border-color: var(--gold);
            box-shadow: 0 20px 50px rgba(212, 175, 55, 0.15);
        }

        /* Gold Accents on Slate */
        .slate-line { width: 30px; height: 2px; background: var(--gold); margin-bottom: 15px; }
        
        /* Badge */
        .type-badge {
            font-size: 9px; letter-spacing: 2px; color: #666; 
            border: 1px solid #333; padding: 4px 8px; border-radius: 2px;
            text-transform: uppercase;
        }

        /* --- THE BLOOM MENU (Refined) --- */
        .hub-container {
            position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%); 
            z-index: 100; display: flex; flex-direction: column-reverse; align-items: center; gap: 20px;
        }
        
        .hub-main-btn { 
            width: 60px; height: 60px; background: var(--gold); color: #050505; 
            border-radius: 50%; display: flex; align-items: center; justify-content: center; 
            font-size: 1.5rem; box-shadow: 0 0 30px rgba(212, 175, 55, 0.2); cursor: pointer;
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 2px solid #fff;
        }
        .hub-main-btn:hover { transform: scale(1.1); box-shadow: 0 0 50px rgba(212, 175, 55, 0.5); }
        
        /* The Fan-Out Menu */
        .bloom-tray {
            display: flex; gap: 15px;
            transition: 0.4s ease-out; opacity: 0; transform: translateY(20px) scale(0.9); pointer-events: none;
            background: rgba(10,10,10,0.8); padding: 10px 20px; border-radius: 50px;
            border: 1px solid #333; backdrop-filter: blur(10px);
        }
        .bloom-tray.active { opacity: 1; transform: translateY(0) scale(1); pointer-events: auto; }
        
        .bloom-item {
            font-family: 'Fira Code', monospace; font-size: 10px; color: #888;
            cursor: pointer; letter-spacing: 1px; padding: 8px 12px;
            transition: 0.3s; border-bottom: 1px solid transparent;
        }
        .bloom-item:hover { color: var(--gold); border-bottom: 1px solid var(--gold); }

        /* --- THE RITUAL SCREEN (New Quote) --- */
        #ritual-screen {
            background: #000; z-index: 500;
            display: flex; align-items: center; justify-content: center;
            transition: opacity 1.5s ease-in-out;
        }
    </style>
</head>
<body>

    <div id="ritual-screen" class="fixed inset-0 cursor-pointer" onclick="enterForge()">
        <div class="text-center">
            <h2 class="lux-serif text-2xl md:text-3xl text-[#E0E0E0] mb-4 tracking-[0.3em]">THE ARCHITECT</h2>
            <p class="text-[#D4AF37] italic font-serif text-sm opacity-60 tracking-widest">"Order from Chaos."</p>
        </div>
    </div>

    <div id="vault-interface" class="hidden opacity-0 transition-opacity duration-1000 forge-theme h-screen flex flex-col justify-center">
        
        <header class="header-stack pt-10">
            <span class="title-veridian lux-serif">VERIDIAN</span>
            <span class="title-hub lux-serif">CODE HUB</span>
            
            <div class="mt-8 relative group">
                <input type="text" id="vault-search" oninput="searchVault()" 
                       placeholder="SEARCH THE ARCHIVE" 
                       class="bg-transparent border-b border-[#333] py-2 w-64 text-center focus:outline-none text-[#D4AF37] tech-mono text-xs placeholder-[#444] tracking-widest transition-all group-hover:w-80 group-hover:border-[#555]">
            </div>
        </header>

        <div id="shelf" class="shelf-container">
            </div>

        <div class="hub-container">
            <div class="hub-main-btn" onclick="toggleBloom()">
                <span id="menu-icon" class="tech-mono font-bold text-xl">+</span>
            </div>
            
            <div id="bloom-tray" class="bloom-tray">
                <span class="bloom-item" onclick="goToOrigin(event)">ORIGIN</span>
                <span class="bloom-item" onclick="window.location.href='socials.html'">SOCIALS</span>
                <span class="bloom-item" onclick="window.location.href='dashboard.html'">MODE</span>
                <span class="bloom-item" onclick="window.location.href='upload.html'">UPLOAD</span>
            </div>
        </div>

    </div>

    <script>
        // System Default Files (The "Examples")
        const systemModules = [
            { id: "sys_1", title: "Protocol_0.js", author: "System", type: "JS" },
            { id: "sys_2", title: "Visual_Core.css", author: "Design", type: "CSS" },
            { id: "sys_3", title: "Manifesto.txt", author: "Root", type: "TXT" }
        ];

        // --- RITUAL LOGIC ---
        function enterForge() {
            const screen = document.getElementById('ritual-screen');
            if(screen.style.opacity === '0') return; // Already fading

            screen.style.opacity = '0';
            setTimeout(() => {
                screen.classList.add('hidden');
                const vault = document.getElementById('vault-interface');
                vault.classList.remove('hidden');
                requestAnimationFrame(() => vault.classList.add('opacity-100'));
                searchVault(); 
            }, 1500);
        }

        // Auto-Trigger for smooth entry
        window.onload = () => { setTimeout(enterForge, 2500); };

        // --- MENU LOGIC ---
        function toggleBloom() {
            const tray = document.getElementById('bloom-tray');
            const icon = document.getElementById('menu-icon');
            tray.classList.toggle('active');
            icon.innerText = tray.classList.contains('active') ? "×" : "+";
        }

        function goToOrigin(event) {
            event.stopPropagation();
            window.location.href = 'origin.html'; 
        }

        // --- DATABASE LOGIC ---
        async function searchVault() {
            const shelf = document.getElementById('shelf');
            const query = document.getElementById('vault-search').value.toLowerCase();
            shelf.innerHTML = ''; 

            try {
                // Connecting to the CORRECT Database
                const forgeData = await localforage.getItem('veridian_forge_data') || [];
                const allFiles = [...systemModules, ...forgeData];
                
                const filtered = allFiles.filter(file => 
                    file.title.toLowerCase().includes(query)
                );

                if(filtered.length === 0) {
                     shelf.innerHTML = `<div class="w-full text-center text-[#333] tech-mono text-xs tracking-widest">VAULT EMPTY</div>`;
                     return;
                }

                filtered.forEach(file => {
                    const card = document.createElement('div');
                    card.className = 'data-slate';
                    card.onclick = () => window.location.href = `reader.html?id=${file.id}`;
                    
                    // Logic to show clean extension
                    let ext = file.type || "DOC";
                    if(file.title.includes('.')) ext = file.title.split('.').pop().toUpperCase();
                    if(ext.length > 4) ext = "FILE";

                    card.innerHTML = `
                        <div>
                            <div class="flex justify-between items-start mb-6">
                                <span class="type-badge tech-mono">${ext}</span>
                                <div class="w-2 h-2 rounded-full bg-[#D4AF37] shadow-[0_0_10px_#D4AF37]"></div>
                            </div>
                            <div class="slate-line"></div>
                            <h3 class="lux-serif text-[#E0E0E0] text-xl tracking-wider leading-snug break-words">
                                ${file.title}
                            </h3>
                        </div>
                        
                        <div class="flex justify-between items-end border-t border-[#222] pt-4">
                            <div class="text-[#555] text-[10px] tech-mono">
                                ID: ${file.id.toString().substring(0,4)}<br>
                                AUTH: ${file.author || 'ME'}
                            </div>
                            <div class="text-[#D4AF37] text-lg opacity-50">➔</div>
                        </div>
                    `;
                    shelf.appendChild(card);
                });
            } catch (err) {
                console.error("Vault Error:", err);
            }
        }
    </script>
</body>
</html>
